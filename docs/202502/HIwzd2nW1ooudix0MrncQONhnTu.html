<h1>把DeepSeek接入WPS，高效办公（保姆级教学）</h1>
<blockquote>来源：<a href="https://ys8xnr7kn3.feishu.cn/docx/HIwzd2nW1ooudix0MrncQONhnTu">https://ys8xnr7kn3.feishu.cn/docx/HIwzd2nW1ooudix0MrncQONhnTu</a></blockquote>
<h2>DeepSeek与Word的梦幻联动，将为你开启高效办公的新篇章！熟悉的Word界面中，只需轻点鼠标，就能召唤出强大的DeepSeek，让它为你快速检索信息、精准翻译文本、智能生成内容……  告别在不同软件间来回切换的繁琐，告别低效的信息获取方式，让办公效率飞起来！</h2>

<h2>效果演示</h2>
<p>按照文本教程完成操作后，Word的选项卡中将会出现DeepSeek的生成图标，选中文本并点击生成，即可实现模型回复！例如，我们想要将一段中文文本翻译成英文：</p>
<p><img src="img/403a8e1a25fcf78d9cff016269e6d4fb.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/X7yyb60gWoimToxR66ncSLPNnyg/"/></p>
<p><img src="img/a02aa0bde84d698d160ca6f75cf35394.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/MqEjbAH3Joyv83xERzRc9VRAnzg/"/></p>
<p>接下来我将详细介绍，如何实现DeepSeek与Word的结合。</p>
<h1>Office AI助手接入方法</h1>
<h1>设置WPS信任</h1>
<p>打开WPS-创建一个文档-点左上角的文件-选项-信任中心</p>
<p><img src="img/6577fac82b1a311b79fe8775286853f3.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Dt2wbZSeDoGWAWxl1cacBur6nEe/"/></p>
<p>启用所有第三方COM加载项，重启WPS后生效(E)，然后点确定</p>

<h2>安装office Ai插件</h2>
<p>下载officeAi助手：https://www.haiyingsec.com/static/introductions/officeai/introduction.html</p>
<p><img src="img/367e8e1dc16759e69342d91691bd54fb.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/MkLnbi6UpoG87Ux3H2hcTp0EnBh/"/></p>
<p>下载好后进行安装，安装前要先把WPS关闭</p>
<p><img src="img/ee814632d5a94b4bc84df3454c6d6e4c.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/U3tNbQhfVo6qXvxbPIrcxdxCnIb/"/></p>
<p>点击完成后就会自动打开WPS，上方就会出现officeAI，登录-点击设置</p>
<p><img src="img/0e39e5758fae840d195dfd6f4fb2d17d.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/MUreb1Fb6oMYNBxENC6cr9cOnZd/"/></p>
<p><img src="img/afa62d67e768947e96f0e22bcb3de5d4.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/FeKHbx6ykoYvvox0HvqcjTFgnsb/"/></p>
<p>平台选择硅基流动的R1，然后模型选择R1，这里还需要添加一个API_key</p>
<h2>获取API Key</h2>
<p>登录硅基流动：https://cloud.siliconflow.cn/i/FSIqvgQd</p>
<p><img src="img/38917b4821ec550f9729ec54c548b486.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/XRHXbquvJort5ExUDBYciBEjnDA/"/></p>
<p><img src="img/33c98a3bf774e32c61f6ab41f90b33d6.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/P1LMbxG9XoPPKmxuuUBck554nXc/"/></p>
<p><img src="img/9b9bfeacdd9225586aaf40d654b636f8.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/ATo4bZXCZoPSMRxeK68cHaNRnty/"/></p>
<p>选择密钥-新建密钥-随便填写-复制密钥到WPS-保存</p>
<p><img src="img/2fd8c4ac4e9c3c1f30f5918fa2edad90.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/SRKhbV8onor16IxYa1ncNQ2mn5d/"/></p>
<p>这样就可以在WPS里使用SeepseekR1了</p>

<h1>VBA插件开发方法</h1>
<h2>设置WPS信任</h2>
<p>跟上面的方法一样，开始之前还需要先设置一下信任问题</p>
<p><img src="img/acd8fa63c7b44c5caad01c238efaa873.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Vluob0KY9o9HnExDpeAc9uG8nif/"/></p>
<p>设置好后记得点确定</p>

<h2>配置WPS</h2>
<p>安装wps.vba，下载地址：https://pan.quark.cn/s/f0e6145a1ab0</p>
<p>点击工具-开发工具-点击VB 编辑器</p>
<p><img src="img/cfa4df355952481c2d33a97c430aeaaf.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/NkuObOs6uoSjMZxZknZcvayWnad/"/></p>
<p><img src="img/50fe6c3176b42f380339a1697ef6fab0.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/C9hBbC8U4oeD39xlhCacPX7BnX3/"/></p>
<p><img src="img/906df8e5abdb1d13673e4e708ec0a13f.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/NmV5bYzTQoHptMxDpjtcB4bNn2R/"/></p>
<p>DeepSeek-V3代码：</p>
<pre>Function CallDeepSeekAPI(api_key As String, inputText As String) As String
    Dim API As String
    Dim SendTxt As String
    Dim Http As Object
    Dim status_code As Integer
    Dim response As String

    API = "https://api.siliconflow.cn/v1/chat/completions"
    SendTxt = "{""model"": ""deepseek-ai/DeepSeek-V3"", ""messages"": [{""role"":""system"", ""content"":""You are a Word assistant""}, {""role"":""user"", ""content"":""" &amp; inputText &amp; """}], ""stream"": false}"

    Set Http = CreateObject("MSXML2.XMLHTTP")
    With Http
        .Open "POST", API, False
        .setRequestHeader "Content-Type", "application/json"
        .setRequestHeader "Authorization", "Bearer " &amp; api_key
        .send SendTxt
        status_code = .Status
        response = .responseText
    End With

    ' 弹出窗口显示 API 响应（调试用）

    ' MsgBox "API Response: " &amp; response, vbInformation, "Debug Info"

    If status_code = 200 Then
        CallDeepSeekAPI = response
    Else
        CallDeepSeekAPI = "Error: " &amp; status_code &amp; " - " &amp; response
    End If

    Set Http = Nothing
End Function

Sub DeepSeekV3()
    Dim api_key As String
    Dim inputText As String
    Dim response As String
    Dim regex As Object
    Dim matches As Object
    Dim originalSelection As Object

    api_key = "替换为你的api key"
    If api_key = "" Then
        MsgBox "Please enter the API key."
        Exit Sub
    ElseIf Selection.Type &lt;&gt; wdSelectionNormal Then
        MsgBox "Please select text."
        Exit Sub
    End If

    ' 保存原始选中的文本
    Set originalSelection = Selection.Range.Duplicate

    inputText = Replace(Replace(Replace(Replace(Replace(Selection.text, "\", "\\"), vbCrLf, ""), vbCr, ""), vbLf, ""), Chr(34), "\""")
    response = CallDeepSeekAPI(api_key, inputText)

    If Left(response, 5) &lt;&gt; "Error" Then
        Set regex = CreateObject("VBScript.RegExp")
        With regex
            .Global = True
            .MultiLine = True
            .IgnoreCase = False
            .Pattern = """content"":""(.*?)"""
        End With
        Set matches = regex.Execute(response)
        If matches.Count &gt; 0 Then
            response = matches(0).SubMatches(0)
            response = Replace(Replace(response, """", Chr(34)), """", Chr(34))

            ' 取消选中原始文本
            Selection.Collapse Direction:=wdCollapseEnd

            ' 将内容插入到选中文字的下一行
            Selection.TypeParagraph ' 插入新行
            Selection.TypeText text:=response

            ' 将光标移回原来选中文本的末尾
            originalSelection.Select
        Else
            MsgBox "Failed to parse API response.", vbExclamation
        End If
    Else
        MsgBox response, vbCritical
    End If
End Sub</pre>
<p>DeepSeek-R1代码:</p>
<pre>Function CallDeepSeekAPI(api_key As String, inputText As String) As String
    Dim API As String
    Dim SendTxt As String
    Dim Http As Object
    Dim status_code As Integer
    Dim response As String

    API = "https://api.siliconflow.cn/v1/chat/completions"
    SendTxt = "{""model"": ""deepseek-ai/DeepSeek-R1"", ""messages"": [{""role"":""system"", ""content"":""You are a Word assistant""}, {""role"":""user"", ""content"":""" &amp; inputText &amp; """}], ""stream"": false}"

    Set Http = CreateObject("MSXML2.XMLHTTP")
    With Http
        .Open "POST", API, False
        .setRequestHeader "Content-Type", "application/json"
        .setRequestHeader "Authorization", "Bearer " &amp; api_key
        .send SendTxt
        status_code = .Status
        response = .responseText
    End With

    ' 弹出窗口显示 API 响应（调试用）

    ' MsgBox "API Response: " &amp; response, vbInformation, "Debug Info"

    If status_code = 200 Then
        CallDeepSeekAPI = response
    Else
        CallDeepSeekAPI = "Error: " &amp; status_code &amp; " - " &amp; response
    End If

    Set Http = Nothing
End Function

Sub DeepSeekR1()
    Dim api_key As String
    Dim inputText As String
    Dim response As String
    Dim regex As Object
    Dim matches As Object
    Dim originalSelection As Object

    api_key = "替换为你的api key"
    If api_key = "" Then
        MsgBox "Please enter the API key."
        Exit Sub
    ElseIf Selection.Type &lt;&gt; wdSelectionNormal Then
        MsgBox "Please select text."
        Exit Sub
    End If

    ' 保存原始选中的文本
    Set originalSelection = Selection.Range.Duplicate

    inputText = Replace(Replace(Replace(Replace(Replace(Selection.text, "\", "\\"), vbCrLf, ""), vbCr, ""), vbLf, ""), Chr(34), "\""")
    response = CallDeepSeekAPI(api_key, inputText)

    If Left(response, 5) &lt;&gt; "Error" Then
        Set regex = CreateObject("VBScript.RegExp")
        With regex
            .Global = True
            .MultiLine = True
            .IgnoreCase = False
            .Pattern = """content"":""(.*?)"""
        End With
        Set matches = regex.Execute(response)
        If matches.Count &gt; 0 Then
            response = matches(0).SubMatches(0)
            response = Replace(Replace(response, """", Chr(34)), """", Chr(34))

            ' 取消选中原始文本
            Selection.Collapse Direction:=wdCollapseEnd

            ' 将内容插入到选中文字的下一行
            Selection.TypeParagraph ' 插入新行
            Selection.TypeText text:=response

            ' 将光标移回原来选中文本的末尾
            originalSelection.Select
        Else
            MsgBox "Failed to parse API response.", vbExclamation
        End If
    Else
        MsgBox response, vbCritical
    End If
End Sub</pre>
<p>选择V3或者R1的代码复制到模块中，记得把代码里面的API key替换成自己的（也就是硅基流动里面复制的）</p>
<p><img src="img/a63dc9af5718fb8e0ce3a7fed19c1fe9.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Op78bdKKLozU1pxMXx5cfCPQnqd/"/></p>
<p>点击 文件 -&gt; 选项 -&gt; 工具</p>
<p>选中，点击新建组，右键新建组，点击重命名，将其命名为"DeepSeek"</p>
<p>选择DeepSeek（自定义），在左侧命令中选择"宏"</p>
<p><img src="img/509179e6d276eb01622612413bce6f59.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/RFVNbZppyohdN6xHIyAceB9Rnsf/"/></p>
<p><img src="img/2a49d13382e7092a0c70195f50f23f71.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/YMSbbY6x4oakuPxQtodcsOHVnTb/"/></p>
<p>找到并选中"DeepSeekR1"，点击添加，点击重命名，重命名为"运行R1"，点击确定</p>
<p><img src="img/26f9032995eb0fe188abe10a473e05df.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/L7rAb37icob0cixQyJsc9uLpnPh/"/></p>
<p>在文档中输入问题，并选取，然后点击运行，稍等一会，就会成功了</p>

<h2>将你的文档另存为 Wps 模板 (.dotm)：</h2>
<p>点击"文件" → "另存为"</p>
<p>选择保存类型为"Microsoft Word 带宏的模板文件 (*.dotm)"</p>
<p>保存到 Wps 的模板文件夹（通常是 C:\Users\用户名\AppData\Roaming\kingsoft\wps\startup，如C:\Users\Administrator\AppData\Roaming\kingsoft\wps\startup）</p>
<p><img src="img/708f6758f94bebc17ace9ecde890ff4f.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Wcvob8TnIoeHT8x73vmcKkl2nnc/"/></p>
<p>这样每次打开 Wps 时，宏就会自动可用</p>
