# 飞书多维表格+扣子，用字段捷径实现自选股股价的一键更新

> 原文：[`www.yuque.com/for_lazy/zhoubao/bg5lbmocnlmi9cnc`](https://www.yuque.com/for_lazy/zhoubao/bg5lbmocnlmi9cnc)

## (24 赞)飞书多维表格+扣子，用字段捷径实现自选股股价的一键更新

作者： 小查

日期：2025-03-17

写这篇的初衷来源于最近加入的一个炒股群，每天群里大佬发车牌，由此产生一个需求：**如何对那么多只自选股票的价格进行快速跟踪？**

按照以前的做法，在收盘后打开 excel 表，对着自选股清单一只只更新股票的收盘价格，费时费力。现在 AI 来了，有没有更高效和自动的方法呢？

结合前一阵学习的飞书多维表格和扣子的知识，钻研了一番，还真是找到了一个**一键更新股票价格** 的方法。

先来直观感受一下效果：

![](img/2f3d750036724ee716077f136d710d42.png "None")

我只输入了一个代码和作为基准的日期，AI 在几秒中内就自动跑出了宁德时代在基准日的收盘价、昨天的收盘价、今天的开盘价和今天的收盘价（因为是在盘中测试，这个收盘价是测试点的实时价格）。

![](img/cbaae69201a22a18950edd916efe1e47.png "None")

整个过程用到了飞书多维表格的 AI 能力 **“字段捷径”** ，使用了两个字段捷径，一个是在“字段捷径中心”找到的别人做的现成捷径，另一个是自己通过扣子开发了一个智能体然后传到多维表格作为一个新的捷径。

本文就手把手教大家怎么来打通这个链路，实现上述的功能。

## 使用“A 股股票查询”字段捷径

### 1. 新建一个多维表格

我们首先要实现的是能够通过股票代码查询出某个指定日期的收盘价，用“字段捷径中心”现成的“A 股股票查询”这个捷径。

新建一个多维表格，新建列“代码”、“发车前一日”和“AI 信息-发车前一日”三个字段：

*   • 代码用于识别股票；

*   • 发车前一日用于设定哪天的收盘价作为价格；

*   • AI 信息-发车前一日利用“代码”和“发车前一日”两个信息来生成想要的“发车前一日收盘价”。

### 2. 对 AI 信息-发车前一日进行设定，使用“A 股股票查询”字段捷径

对“AI 信息-
发车前一日”这列进行“修改字段/列”，选择“探索字段捷径”，搜索“A 股股票查询”并选中，这个字段捷径需要两个输入参数，想要查询的股票代码所在的字段和日期所在的字段，分别指向刚刚创建的“代码”和“发车前一日”。  选中“获取更多信息”，可以看到这个字段捷径提供了开盘价、最高价、最低价、收盘价、成交量（股）、股票代码 6 种信息。  我们现在只想拿到收盘价的信息，于是收盘价前打勾。  多维表格会自动在右侧创建新的一列“AI 信息=发车前一日.收盘价”。

![](img/cb75464f1ca81dbd2bd3d0df1c03965f.png "None")

至此，在输入股票代码和日期的情况下就可以自动获取到该日该股票的收盘价，对于基本需求已经能够满足。但如果我想获取更多信息怎么办？比如我想获取代码对应的股票名称、前一日的收盘价、甚至是一些财务报表信息该怎么办呢？

这个字段捷径功能有限，如何满足我更多个性化的需求呢？

前几天学到从扣子做智能体传到多维表格的方法，当时举的例子是做小红书分析，那是不是用同样的方法来做类似的事情呢？

想都是问题，干才有答案。

## 做一个自己的股票信息字段捷径

### 1. 新建一个扣子智能体

在扣子里新建一个智能体，选择“单 Agent（对话流模式）”

![](img/6218e0571c5e0f32f05580ffc332d97c.png "None")

### 2. 新建一个工作流，用于获取股票信息

在扣子的资源库里新建一个工作流，，这个工作流只有开始、SearchStockData、结束三个节点。

![](img/737a9a42d47c4846d132611496758f9c.png "None")

其中，开始节点有两个输入参数 date 和 symbol

![](img/f61233c38f538dff6b5293f67f50cf54.png "None")

中间的节点是核心节点，我们使用了扣子提供的一个插件：新浪财经，其中有一个 SearchStockData 的功能

![](img/31b1e776c9963b260753ef39714b43c5.png "None")

我们来仔细看看这个插件节点能提供什么信息。  他提供的信息分为基础信息、财务信息和市场信息，

![](img/a3e8bd7988e9f423358d799fe83c2e82.png "None")

基础信息包括代码、名称和上市市场。财务信息包括财务报表里的基础财务数据。

![](img/4d22adcc23cbd01be466ab51e5e53471.png "None")

我们最关心的市场信息里提供了开盘价、收盘价、最高价、最低价、前一日收盘价、涨幅、交易量等信息，比之前那个“A 股股票查询”里提供的信息多很多，非常好。

![](img/3c43d0f1b8dbe22a837d1b9d15efb601.png "None")

赶快把这个节点插在开始节点后，只需要让输入来自开始节点的两个输入参数即可。

![](img/af0572e3918af1c5131a5ce757805cbb.png "None")

结束节点，需要我们设置想要输出的结果，我们先获取股票代码、名称、日期、前一日收盘价、当日开盘价、当日收盘价这 6 个信息。

![](img/6b254e5caf0e33fa1b243d70e9af8622.png "None")

工作流试运行成功后点发布，工作流已经做好。

### 2. 新建一个对话流，嵌入工作流

在扣子的资源库里新建一个对话流，，这个对话流只有开始、刚刚建的 stock 工作流、结束三个节点。

![](img/4a6a6ae4abb9e0a4e89d452365297404.png "None")

其中，开始节点不能够进行修改

![](img/d66ce921b52dc8c904321d5206ef5f8c.png "None")

stock 工作流节点设置输入参数来自开始节点

![](img/e9668012da51f511a82a5334bfab7099.png "None")

结束节点把需要输出的 6 个变量都跟 stock 工作流节点对应的字段连接好，并且在回答内容中进行引用。

![](img/ef4ecfd6f3daf2c646658767a881f3f4.png "None")

对话流进行测试，确认无误后可以发布

![](img/fd69a9330234ca33974694813abc674d.png "None")

### 3.发布成为一个多维表格的字段捷径

在扣子的资源库里新建一个对话流，，这个对话流只有开始、刚刚建的 stock 工作流、结束三个节点。  回到我们在第一步创建的那个智能体，添加刚刚做好的对话流。

![](img/b704def19d3421dc033e5cf8380507cd.png "None")

点击发布（进入关键步骤，注意操作）  我们只发布给飞书多维表格，所以把其他对勾勾掉

![](img/ebac0d5c1011a4f2f6cdea5af07762cb.png "None")

如果是第一次操作，需要做一次授权，即允许你的飞书账号与扣子关联。  授权完成后，还要点击配置按钮进行配置。需要填两个信息，标题代表着出现在字段捷径里这一项的名字，**控件一定要选“字段选择器”** ！可以把文本、数字、复选框勾上。

![](img/33302e8378ef9469b48a210a5ec3563a.png "None")

![](img/99f2d45342ceb82262015e200671c04c.png "None")

接着完善捷径上架信息，点击去填写，一共填写 6 项信息，其中 coze 发布范围可以填“仅自己可用”，这样会缩短审核时间。

![](img/69341762b7d23a539ac9690828343404.png "None")

然后点击发布，会看到发布成功的字样，状态为“审核中”

![](img/fce5b6279e2163a1f6dfb46dda79cce7.png "None")

一般来讲，审核时间为 1-2 小时，现在还是蛮快的。

### 4.在多维表格中使用自己创建的字段捷径

回到多维表格，我们首先创建一个新列，叫它 stock from coze。  如果你的字段捷径已经审核通过，在字段捷径中心就可以搜索得到（为了方便演示，这里使用了一个我之前创建并审核通过的捷径）

![](img/b717d8e8277733d9a73c78cc33072517.png "None")

在配置里只需要指向代码，然后打开自动更新

![](img/40929147aecbe6d7203aeab9f58e0361.png "None")

到这一步的效果你会发现根据你在 A 列的代码，stock from
coze 这个单元格被自动填充内容，内容就是你之前在对话流里获取的 6 项信息：股票代码、名称、今日收盘价、今日日期、前一日收盘价、今日开盘价。

![](img/2961b5da8399c1513ac14782dd7a8677.png "None")

这里有两个小点我没有找到如何更好地控制，一是这 6 项数据的顺序，看不出来是怎样的，肯定不是我在工作流设置的顺序。好在这个顺序是固定的，可以先记录和识别下，搞清楚哪个数字对应的是今日收盘价、今日开盘价、前一日收盘价。

第二点是里面的日期默认是今天，没办法选到其他日期，我尝试在工作流层面进行了调整，希望能够多参数输入，但始终没有成功。如果哪位大神有解决方案，也欢迎赐教。

总之，我们得到了一个根据股票代码自动生成的股票信息，而且这个股票信息可以展示的内容是可以通过在扣子里的调整自行控制的，你甚至可以展现这只股票的财务信息（只要在新浪财经插件提供范围内）。

### 5.在多维表格中 AI 自动提取信息

为了方便使用，我们在多维表格里再创建几列，分别是股票名称、前一日收盘价、今日开盘价和今日收盘价，方便查看和使用。

名称的话我们使用默认的信息提取字段捷径，指定让它基于 stock from coze 这一列的内容提取里面的股票名称

![](img/33274247902e630d781cf7deaee144f5.png "None")

其余三个价格我用一段提示语来控制输出结果，再给它一个具体的例子学习，具体可以查看图片中的内容。我发现，现在的 AI 不仅能听懂你说话了，还会数数了。

![](img/ce1564f8b4e96a41a1bda8e36d3c8a4e.png "None")

至此，大功告成。

### 6.利用飞书多维表格做查询页面和仪表盘

自动获取到这些数据后，飞书多维表格相当于变成了你的数据库，利用多维表格的其他功能，你还可以给它补上一个输入页面和输出页面，这样一个完整的小系统就做出来了。

![](img/00031fa2bc801e83009bbe30e01aa3ff.png "None")

![](img/99134f3f5bd24ea31a1a2c409e43901f.png "None")

## 总结

整个过程给我最大的感触是，借助 AI 的力量，**我完全可以把自己个性化的需求和想法变成一个小小的产品** ，而这个实现的过程也是一个**干中学** 的过程。多维表格不知道怎么用 AI，去找教程、看直播、问高手；扣子不知道怎么做完传到多维表格，去找教程、看直播、问高手，通过自己动手动脑最终实现自己想法的乐趣才是最大的奖赏。

这个例子就是从我自身需求出发，利用多维表格和扣子实现了效率极大提升。举一反三，如果有其他需要提效的场景，是不是也能用这套方法去实现呢？欢迎大家提出类似的场景需求，多多碰撞、多多讨论。

* * *

评论区：

渊杰 : 新浪和另一个地方🈶拿实时股价的接口