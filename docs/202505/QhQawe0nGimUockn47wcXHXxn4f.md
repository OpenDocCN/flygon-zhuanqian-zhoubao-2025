# creemæ”¯ä»˜é…ç½®ï¼šå°ç™½è§†è§’å’Œè·¯å¾„ï¼Œæ‰‹æŠŠæ‰‹æ•™å­¦

> æ¥æºï¼š[https://ewtk6agpo4c.feishu.cn/docx/EiFEdIjdqo5a2sxecjpcYBS5nRh](https://ewtk6agpo4c.feishu.cn/docx/EiFEdIjdqo5a2sxecjpcYBS5nRh)

ç½‘ç«™å‡ºæµ·èµšç¾é‡‘æ˜¯æ¯ä¸€ä¸ªå‡ºæµ·äººåœ¨åšçš„äº‹å„¿ï¼Œèµšç¾é‡‘ï¼Œæˆ‘ä»¬æŠŠå·¥å…·åšå¥½äº†ï¼Œå°¤å…¶æ˜¯ä¸€æ¬¡æ€§æ”¯ä»˜æˆ–è€…è®¢é˜…çš„è¿™ç§å·¥å…·ï¼Œå°±éœ€è¦æœ‰ä¸€ç§æ”¯ä»˜å·¥å…·å¸®åŠ©æˆ‘ä»¬â€œæ”¶æ¬¾ç¾é‡‘â€ï¼Œå¸¸è§çš„stripeéœ€è¦åŠç†æ¸¯å¡ï¼Œä¸”å°æ§ä¸¥æ ¼ï¼Œæ–°æ‰‹æä¸å‹å¥½ï¼›PayPalçš„è¯ç”µå•†ç¡®å®å¸¸è§ï¼Œåªæ˜¯å¿…é¡»éœ€è¦å…¬å¸ï¼Œå¯¹äºç‹¬ç«‹ä¸ªä½“ä¹Ÿä¸æ–¹ä¾¿ï¼Œè¿™æ—¶å€™Creemå‡ºç°äº†ï¼

*   ä¸­å›½äººå‹å¥½

*   ç›´æ¥æ‰“æ¬¾æ”¯ä»˜å®

*   æ”¯ä»˜æ¥å…¥ç®€å•

è¿™å‡ ä¸ªåœ¨ä¸€èµ·ï¼Œâ€œå¦‚æœæ˜¯çœŸçš„â€ï¼Œé‚£å¾ˆç‹ç‚¸å•Šï¼

ç¬¬ä¸€æ¬¡çœ‹åˆ°creemæ”¯ä»˜æ˜¯åœ¨è¿™ç¯‡æ–‡ç«  æµ·å¤–æ”¯ä»˜å¹³å°Creemæ³¨å†Œæ•™ç¨‹

![](img/85e849c9c572ed7be48206c0d3f958ff.png)

å½“æ—¶çš„è¯´æ³•æ˜¯ï¼Œè¿™ä¸ªæ”¯ä»˜åªéœ€è¦20åˆ†é’Ÿå°±èƒ½æå®šï¼Œæˆ‘ä¿¡äº†ï¼Œæ³¨å†Œåˆ°å®¡æ ¸ç¡®å®åªè¦20åˆ†é’Ÿï¼Œä½†æ˜¯åé¢çš„æ“ä½œï¼Œè®©ä½œä¸º0åŸºç¡€å°ç™½çš„æˆ‘å´©æºƒäº†ã€‚ç»è¿‡äº†2å‘¨çš„çˆ±æ¨çº ç»“ï¼Œç»ˆäºè¿˜æ˜¯æŠŠè¿™ä¸ªcreemç»™è£…å®Œäº†äº†ï¼Œï¼Œ3æœˆåº•æ¥å®Œäº†æ”¯ä»˜ä¹Ÿå†™äº†è¿™ç¯‡æ–‡ç« çš„80%ï¼Œä½†æ˜¯è¿˜æ˜¯æ‹–åˆ°äº†5æœˆä¸­æ‰çœŸæ­£æŠŠcreemçš„æ”¯ä»˜ç»™â€œæ‹¿ä¸‹â€ï¼Œä»Šå¤©å°±ç”¨å°ç™½çš„è§†è§’å¸®å¤§å®¶ä¸€èµ·æ¢³ç†æ¥creemæ”¯ä»˜çš„æ¯ä¸€ä¸ªæ­¥éª¤ã€‚

æ–‡ç« ä¸»è¦åŒ…å«å››ä¸ªéƒ¨åˆ†ï¼š

1.  æ³¨å†Œcreemè´¦å·

1.  å‡†å¤‡å„ç§creemçš„ä¿¡æ¯

1.  webhookå’Œngrokï¼ˆæœ‰äº›æƒ…å†µä¸éœ€è¦ï¼‰

1.  æ­£å¼é…ç½®æ”¯ä»˜

# ä¸€ã€æ³¨å†Œè´¦å·+å®Œå–„ä¿¡æ¯

## 1\. æ³¨å†Œè´¦å·ï¼ˆgoogleå¯ç›´æ¥ç™»å½•ï¼‰

ç›´é€šè½¦ï¼Œå¯ä»¥ç›´æ¥googleç™»å½• æˆ–è€…é‚®ç®±æ³¨å†Œï¼Œæ³¨å†ŒæˆåŠŸå°±ä¼šè¿›å…¥ä¸‹é¢çš„é¡µé¢

![](img/c66360fa20ca3c8fded1df28da9cd5c8.png)

![](img/b131c648d35ecb73fbec1b3f1a50eda8.png)

## å®Œå–„æç°ä¿¡æ¯

### 2.1 åˆ›å»ºæç°è´¦å·

åœ¨Balanceçš„Payout Accountä¸­ï¼Œé€‰æ‹©åˆ›å»ºä¸€ä¸ªæ–°çš„è´¦å·ï¼Œå›½å®¶é€‰æ‹©Chinaï¼Œ

![](img/e38794ac2a89f803006834c513650afe.png)

### 2.2 å¡«å†™ä¸šåŠ¡ä¿¡æ¯

ä¸»è¦å¡«å†™ä½ çš„åŸºæœ¬ä¿¡æ¯å’Œä½ çš„äº§å“æ˜¯åšä»€ä¹ˆçš„

![](img/391524bba55d44e0b46c7bebef0353a4.png)

### 2.3 å®Œå–„ä¸ªäººä¿¡æ¯

è¯·æŒ‰ç…§ä¸‹é¢çš„æµç¨‹ï¼Œå®Œæˆä¸ªäººä¿¡æ¯å¡«å†™ï¼Œä¸Šä¼ å¤§é™†èº«ä»½è¯çš„æ­£åé¢ï¼Œå¹¶ä¸”ç”µè„‘æ‘„åƒå¤´æ‹ç…§ï¼Œæœ€ç»ˆä½ çš„ä¸ªäººä¿¡æ¯ä¼šè¢«ä¿å­˜åˆ°Sumsub IDä¸­ã€‚

![](img/c54ae08be31c74078c04d1f80e546368.png)

![](img/a4c576a831b61ff7e4a8b2e7f9d3ab06.png)

æäº¤å®Œä»¥åï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ï¼š

![](img/d59b5809fdc36f78cec241d9f8e47812.png)

![](img/33d88964acf8f5f1801031ab44667dda.png)

è«æ…Œï¼Œç­‰å¾…å³å¯ï¼Œå¤§æ¦‚è¿‡äº†24å°æ—¶ï¼Œå°±ä¼šé‚®ä»¶é€šçŸ¥ å®¡æ ¸é€šè¿‡ï¼

å½“ç„¶ ä½ ä¹Ÿæœ‰å¯èƒ½æ˜¯ ç›´æ¥é€šè¿‡çš„é‚£ç§

![](img/eb45ff5d3a55022ede5681b297b93738.png)

![](img/b769313d5c5ab2c8cc5eefd15d96f102.png)

### 2.4 å®Œå–„æç°ä¿¡æ¯

ç‚¹å‡»Payout Detailsçš„Manage Payout Accountï¼Œå®Œå–„æç°ä¿¡æ¯ã€‚

![](img/9cdde8b259401153407c2fca9e088a7c.png)

å¡«å†™æç°è´¦å·çš„å›½å®¶ï¼Œé€‰æ‹©Chinaï¼Œå¸ç§é€‰æ‹©CNYï¼Œè½¬è´¦æ–¹å¼é€‰æ‹©æ”¯ä»˜å®ã€‚

æ¥ç€å¡«å†™æ”¯ä»˜å®çš„è´¦å·ï¼Œé‚®ç®±åœ°å€å’Œå…¨åï¼ˆä¸­æ–‡åï¼‰ã€‚

![](img/91d3be050bd1c2353d2450d60984f647.png)

æœ€åå¡«å†™ä½ çš„å®¶åº­åœ°å€ï¼Œè¿™é‡Œå¦‚å®å¡«å†™å³å¯ã€‚æäº¤ä¹‹åï¼Œä¸ªäººä¿¡æ¯å’Œæç°ä¿¡æ¯å°±å®Œå–„å¥½äº†ã€‚

![](img/f9976e17b67c7152ff28da55cb13f6a0.png)

### 2.5 ç­‰å¾…å®¡æ ¸

æœ€åå°±æ˜¯ç­‰å¾…å®¡æ ¸ï¼Œå¿«çš„è¯ï¼ŒåŠå¤©åˆ°ä¸€å¤©å°±å¯ä»¥ç»“æœã€‚

![](img/039aa4e2a8cc3e2ab172b13d52cfe780.png)

# äºŒã€å‡†å¤‡2å¥—é…ç½®ä¿¡æ¯

æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„é…ç½®ä¿¡æ¯ä¸ä¸€æ ·ï¼

è¿™ä¸ªéå¸¸çš„é‡è¦ï¼å½“åˆæˆ‘è·Ÿå½©ç¬ºéƒ½å¿½ç•¥äº†â€œtest modeâ€è¿™ä¸ªä¸œè¥¿ï¼

æ‰“å¼€å’Œå…³æ‰ï¼Œæ˜¯å®Œå…¨çš„2å¥—å†…å®¹ï¼Œæ‰€ä»¥ä¸‹é¢æ‰€æœ‰çš„ä¸œè¥¿ï¼Œéƒ½è¦åš2éã€‚

ä¸€ä¸ªæ˜¯ test modeä¸€ä¸ªæ˜¯étest mode

![](img/e9a9574e12ceb972023dcf2c51a7a80c.png)

## 1\. product

é¦–å…ˆæ˜¯æ³¨å†Œäº§å“

product--->add product

![](img/924afac9cd86e2e794d9712359d947d7.png)

### 1.1 product details

![](img/a691fd084e3f1ed719707535256318c3.png)

nameï¼šäº§å“åå­—

return urlï¼šç”¨æˆ·åœ¨æ”¯ä»˜å®Œæˆä»¥åï¼Œä½ å¸Œæœ›å¯¹æ–¹è¿”å›çš„é¡µé¢

descriptionï¼šäº§å“ä»‹ç»ï¼ˆå¯ä»¥è®©aiç”Ÿæˆå•¦ï½ï¼‰

statusï¼šé€‰æ‹©activeï¼ˆæ¿€æ´»çŠ¶æ€ï¼‰

image preview:äº§å“å›¾ï¼Œå¯ä»¥ä¸Šä¼ ï¼Œå¯ä»¥ä¸ä¸Šä¼ 

### 1.2 payment details

![](img/e868b37f5a85d262a9d0f43256dbf63d.png)

æ”¯ä»˜æ–¹å¼ï¼šä½ æ˜¯ä¸€æ¬¡æ€§æ”¯ä»˜ï¼ˆsingle paymentï¼‰è¿˜æ˜¯ è®¢é˜…ç±»å‹ï¼ˆsubscritionï¼‰çš„æ”¯ä»˜

curencyï¼šè´§å¸æ–¹å¼

price:è‡ªå®šä¹‰ä»·æ ¼

tax categoryï¼šä¸€èˆ¬é€‰æ‹©â€œdigital goods or serviceâ€ï¼ˆè™šæ‹ŸæœåŠ¡ï¼‰

tax behaviourï¼šæ˜¯å¦åŒ…å«ç¨ï¼ˆçœ‹ä¸ªäººæƒ…å†µé€‰æ‹©

### 1.3 product other infomation

![](img/acb25ed2fdf8c8f79bf5ec481cdff039.png)

å›¾ç‰‡ã€ç‰¹æ€§ã€å…¶ä»–...

è¿™äº›å†…å®¹éƒ½èƒ½è®©aiæå®š

å¡«å†™å®Œæˆä»¥å ç‚¹å‡»â€œcreate productâ€

### 1.4 productä¿¡æ¯

åœ¨producté¡µé¢ è‡ªå·±åˆ›å»ºçš„äº§å“ æœ‰ä¸‰ä¸ªç‚¹ï¼Œç‚¹å‡»ä»¥å å¯ä»¥å¤åˆ¶è‡ªå·±çš„product id

![](img/24fb3cd676374ed19d2f8c3ca0f405ab.png)

## 2\. api key

![](img/22e70cc2144918a03bd8e830cf6b2da7.png)

ç‚¹å‡»å³ä¸Šè§’çš„ developerå°±åˆ›å»ºè‡ªå·±çš„api key

è®°å¾—åˆ›å»º2ç»„ï¼Œtestå’Œétestçš„ è¿™æ˜¯2ä¸ªä¸åŒçš„

# ä¸‰ã€webhook&ngrokï¼ˆé€‰æ‹©æ€§ï¼‰

## 1 ä»€ä¹ˆæ˜¯webhook

ç›´é€šè½¦

Webhook å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç½‘ç»œé€šçŸ¥å™¨"ã€‚

æƒ³è±¡ä½ åœ¨ç­‰å¿«é€’ï¼Œæœ‰ä¸¤ç§æ–¹å¼çŸ¥é“å¿«é€’åˆ°äº†ï¼š

1.  ä¼ ç»Ÿæ–¹å¼ï¼šä½ æ¯éš”ä¸€ä¼šå„¿å°±è¦æ‰“å¼€App æŸ¥çœ‹å¿«é€’åˆ°å“ªäº†ï¼ˆè¿™å°±åƒä¼ ç»Ÿçš„è½®è¯¢æ–¹å¼ã€‚éš”ä¸€æ®µæ—¶é—´å°±é—®ï¼Œç„¶åå¾—åˆ°å›å¤ï¼‰

1.  Webhook æ–¹å¼ï¼šå¿«é€’å‘˜åˆ°äº†ç›´æ¥ç»™ä½ æ‰“ç”µè¯ï¼ˆè¿™å°±æ˜¯ Webhook çš„å·¥ä½œæ–¹å¼ï¼‰

## 2 æ€ä¹ˆåˆ¤æ–­è‡ªå·±éœ€ä¸éœ€è¦

![](img/3cc3751436867f1dba123bc2170bf7e4.png)

ä»¥ä¸‹æƒ…å†µä½ å¯èƒ½éœ€è¦ Webhookï¼š

1.  éœ€è¦å®æ—¶é€šçŸ¥

*   ç”¨æˆ·ä¸‹å•åç«‹å³é€šçŸ¥å•†å®¶

*   æœ‰äººåœ¨ä½ çš„åšå®¢ç•™è¨€åç«‹å³æ”¶åˆ°æé†’

1.  éœ€è¦è‡ªåŠ¨åŒ–å¤„ç†

*   ç”¨æˆ·ä»˜æ¬¾æˆåŠŸåè‡ªåŠ¨å‘è´§

*   æœ‰äººæäº¤è¡¨å•åè‡ªåŠ¨å‘é€ç¡®è®¤é‚®ä»¶

1.  éœ€è¦ç³»ç»Ÿè”åŠ¨

*   Github ä»£ç æ›´æ–°åè‡ªåŠ¨éƒ¨ç½²ç½‘ç«™

*   è®¢å•ç³»ç»Ÿå’Œåº“å­˜ç³»ç»Ÿéœ€è¦å®æ—¶åŒæ­¥

å¦‚æœä½ çš„ç½‘ç«™ä¸éœ€è¦è¿™äº›å®æ—¶æ€§æˆ–è‡ªåŠ¨åŒ–çš„åŠŸèƒ½ï¼Œå¯èƒ½å°±ä¸éœ€è¦ Webhookã€‚

## 3 å‡†å¤‡webhook

å¦‚æœç»†å¿ƒçš„æœ‹å‹ä¼šå‘ç°ï¼Œåˆšåˆšåœ¨åˆ›å»ºapi keyçš„æ—¶å€™ æ—è¾¹å°±æœ‰ä¸€ä¸ª webhooks

![](img/f6eae7c2a25c4437edd16289fa9a4fd9.png)

ç‚¹å‡»add webhookåªéœ€è¦å¡«å†™ä¸¤ä¸ªä¿¡æ¯

webhook nameï¼šå–ä¸ªåå­—ï¼Œè¿™ä¸ªé€šçŸ¥å™¨æ˜¯é€šçŸ¥ä»€ä¹ˆçš„

webhook urlï¼šè¿™ä¸ªåœ°æ–¹çš„urlæ˜¯æŒ‡ï¼Œåœ¨æ”¯ä»˜å®Œæˆä»¥åï¼Œcreeméœ€è¦å‘å“ªä¸€ä¸ªpageä¼ è¾¾é€šçŸ¥ã€‚

é‚£è¿™ä¸ªurlå…·ä½“è¦æ€ä¹ˆå¡«å†™å‘¢ï¼Ÿ

### 3.1 étest mode

*   ç›´æ¥è®©cursorå‘Šè¯‰ä½  éœ€è¦é‚£ä¸ªé¡µé¢æ¥æ¥æ”¶é€šçŸ¥ï¼Œä»–å°±ä¼šç»™ä½ ä¸€ä¸ªè·¯å¾„ï¼ŒåŸŸå+pathå³å¯.ä¾‹å¦‚ä¸‹é¢çš„

```
www.XXXX.com/payment/result
```

### 3.2 test mode

æŒ‰ç†è¯´åº”è¯¥æ˜¯

```
http://localhost:3000/payment/result
```

ä½†æ˜¯ ä½ å¡«è¿›å» å°±å¾—åˆ°é€šçŸ¥ï¼Œä¸èƒ½ä½¿ç”¨æœ¬åœ°çš„è·¯å¾„ï¼Œå¿…é¡»ä½¿ç”¨å…¬å¼€çš„URLã€‚æ‰€ä»¥è¿™ä¸ªæ—¶å€™ä½ å°±éœ€è¦ä¸€ä¸ªæ–°çš„ä¸œè¥¿ngrokã€‚

å…·ä½“çœ‹ä¸‹ä¸€ä¸ªpartçš„å…·ä½“å®æ“

ç»è¿‡ngrokçš„æ“ä½œä»¥åï¼Œæœ¬åœ°è¿æ¥å°±ä¼šå˜æˆä¸€ä¸ªå¯ä»¥ç”¨çš„public url

```
https://8733-191-204-177-89.sa.ngrok.io/payment/result
```

### 3.3 è·å– webhookRUL

åˆ›å»ºå®Œæˆä»¥å è·å– webhookçš„URL

![](img/a61279eee9f1d9d7523a7522de2f2c7c.png)

### 3.4 è·å–webhookçš„secret

![](img/3df020153856a9d7217038d08a5f9bf8.png)

![](img/3b0dab96944ea88cac5af9251b10c690.png)

## 4\. ngrok

ngrok æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„ç½‘ç»œå·¥å…·ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å¸®åŠ©æˆ‘ä»¬å®ç°"å†…ç½‘ç©¿é€"ï¼Œå¼€å‘è€…å¯ä»¥è®©å…¶ä»–äººå®æ—¶æŸ¥çœ‹æœ¬åœ°å¼€å‘çš„ç½‘ç«™

### 4.1 æ³¨å†Œè´¦å·

ngrok

å¯ä»¥googleç›´æ¥ç™»å½•ï¼Œç‚¹å‡»èœå•æ çš„ â€œyour authtokenâ€ï¼ŒæŸ¥çœ‹å¹¶å¤åˆ¶ä½ çš„token

![](img/8df2ea4dff4c75e93c40ced08ffbac2b.png)

![](img/d829824ad6c4d0535acc0238896b82ff.png)

### 4.2 å®‰è£…ngrok

#### 4.2.1 ä¸‹è½½

```
brew install ngrok
```

ä¹Ÿå¯ä»¥ç›´æ¥ç‚¹å‡»â€œdownloadâ€è¿›è¡Œä¸‹è½½ï¼Œé€‰æ‹©å¯¹åº”çš„èŠ¯ç‰‡

![](img/03f15c4d730c03272a1b3f24421a7dc5.png)

#### 4.2.2 åŠ å…¥token

æ·»åŠ  authtokenåˆ°ç”µè„‘ä¸Šï¼Œç»ˆç«¯è¿è¡Œä¸‹é¢å†…å®¹

```
ngrok config add-authtoken ä½ çš„token
```

### 4.3 ä½¿ç”¨ngrok

å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡ï¼Œç»ˆç«¯è¿è¡Œä¸‹é¢ğŸ‘‡

```
npm start
```

è¿è¡Œngrokï¼Œä¸€èˆ¬ç¨‹åºåœ¨3000ç«¯å£ï¼Œå¦‚æœä½ çš„æœ‰æŒ‡å®šä¿®æ”¹ç«¯å£å³å¯

```
ngrok http 3000
```

è¿è¡Œå®Œä»¥åä¼šå‡ºç° ç±»ä¼¼ä¸‹é¢çš„å›¾ï¼Œå°±å¾—åˆ°äº†localçš„pathå¯¹åº”çš„public URL

![](img/b8a3b174de83b8f9246ab5422a1e15c3.png)

æœ€åå†æŠŠæˆ‘ä»¬éœ€è¦çš„å…·ä½“pathæ¢è¿›å»ä¾‹å¦‚

```
localhost:3000/payment/result
```

Public URLå°±æ˜¯

```
https://08f7-115-196-182-99.ngrok-free.app/payment/result
```

### 4\. æ³¨æ„äº‹é¡¹

å…è´¹ç‰ˆæœ¬çš„ï¼Œæ¯ä¸€æ¬¡ run ngrokä»¥å éƒ½ä¼šç”Ÿæˆä¸€ä¸ªéšæœºçš„urlã€‚

å¦‚æœä½ å…³é—­äº†terminalä»¥åï¼Œå†æ¬¡æ‰“å¼€ï¼Œå°±ä¼šç”Ÿæˆå¦å¤–ä¸€ä¸ªURLï¼Œä½ å°±éœ€è¦å»creemé‡Œé¢æ›´æ¢mode æ¨¡å¼ä¸‹çš„ webhookçš„URLï¼

# å››ã€é…ç½®

## 1\. æ£€æŸ¥é…ç½®ä¿¡æ¯

ç»è¿‡ä»¥ä¸Šç§ç§ ï¼Œæˆ‘ä»¬åº”è¯¥å°±å¾—åˆ°äº†ä¸‹é¢çš„æ‰€æœ‰ä¸œè¥¿

envæ–‡ä»¶

```
CREEM_API_KEY=
CREEM_PRODUCT_ID=
CREEM_API_URL=https://api.creem.io
CREEM_SUCCESS_URL=
```

### api_key

```
CREEM_API_KEY=
CREEM_API_KEY_TEST=
```

### product_id

```
CREEM_PRODUCT_ID=
CREEM_PRODUCT_ID_TEST=
```

### api URL

è¿™ä¸ªå¥½åƒæ˜¯é€šç”¨çš„

```
CREEM_API_URL=https://api.creem.io
CREEM_API_URL_TEST=https://test-api.creem.io
```

### webhook ç›¸å…³

```
CREEM_WEBHOOK_URL_test=
CREEM_WEBHOOK_URL=
CREEM_WEBHOOK_secret_test=
CREEM_WEBHOOK_secret=
```

### æ”¯ä»˜æˆåŠŸä»¥åè¦è¿”å›çš„é¡µé¢è·¯å¾„

```
CREEM_SUCCESS_URL=
CREEM_SUCCESS_URL_TEST=
```

## 2\. ä½¿ç”¨cursorè¿æ¥

### 2.1 æ”¯ä»˜çš„é€»è¾‘

æˆ‘è®©aiç»™æˆ‘ç”»äº†ä¸€ä¸ªè¯´æ˜çš„æµç¨‹å›¾ï¼Œç»“æœæ„Ÿè§‰ç”»çš„éå¸¸å¤æ‚ï¼Œçœ‹èµ·æ¥å¯èƒ½çœŸçš„è¿™ä¹ˆå¤æ‚ï¼Œç®€å•æ¥è¯´å°±æ˜¯ï¼Œ

*   å‰ç«¯çœ‹åˆ°çš„ï¼šç”¨æˆ·ç‚¹å‡»ä»˜æ¬¾æŒ‰é’®--->è·³è½¬ä»˜æ¬¾é¡µé¢--->å¡«å†™ä¿¡æ¯ä»˜æ¬¾æˆåŠŸ--->è¿”å›æŸä¸ªé¡µé¢/è·å¾—ç§¯åˆ†

*   åç«¯å®é™…ï¼šæœåŠ¡å™¨å‘èµ·è¯·æ±‚--->æ”¯ä»˜ç«¯æ”¶åˆ°è¯·æ±‚ï¼Œç»™äº†ä¸€ä¸ªä»˜æ¬¾è¿æ¥--->æœåŠ¡å™¨æŠŠä»˜æ¬¾è¿æ¥ä¼ ç»™ç”¨æˆ·--->ç”¨æˆ·æ”¯ä»˜--->æ”¯ä»˜ç«¯æ”¶åˆ°æ”¯ä»˜é€šçŸ¥--->æ”¯ä»˜ç«¯ç»™æœåŠ¡å™¨å›ä¼ æ¶ˆæ¯ï¼ˆé€šçŸ¥æ”¯ä»˜å®Œæˆï¼‰

å¤§æ¦‚å°±æ˜¯è¿™ä¹ˆä¸ªæ„æ€ï½ï¼ˆä¸»æ‰“ä¸€ä¸ªçœ‹å›¾è¯´è¯

ç½‘ç«™çš„æ”¯ä»˜å°±2ç§ï¼Œä¸€æ¬¡æ€§ï¼ˆpay one-timeï¼‰&è®¢é˜…ï¼ˆsubscribeï¼‰ï¼Œä¸‹é¢å°±æ‰‹æŠŠæ‰‹æŠŠå¸¦å¤§å®¶å°è¯•ä¸€ä¸‹ ä¸€æ¬¡æ€§ä»˜è´¹ã€‚

é…ç½®è§„åˆ™æ–‡æ¡£ç›´é€šè½¦

### 2.2 ä¸€æ¬¡æ€§ä»˜è´¹ï¼ˆReturn URLï¼‰

ä¸€å¥è¯è¯´é€»è¾‘å°±æ˜¯ï¼šé…ç½®è§„åˆ™åœ¨è¿™é‡Œï¼Œæˆ‘æœ‰è¿™äº›é…ç½®ä¿¡æ¯ï¼Œæˆ‘å¸Œæœ›å®ç°ä»€ä¹ˆæ•ˆæœï¼Œä½ å¸®æˆ‘å†™

åˆ’é‡ç‚¹â€œé…ç½®ä¿¡æ¯â€ã€â€œé…ç½®è§„åˆ™â€ã€â€œå®ç°æ•ˆæœâ€

å°±æ˜¯è¿™3ä¸ªå†…å®¹ï¼Œé…ç½®ä¿¡æ¯ä¸Šé¢æˆ‘ä»¬å·²ç»æå®šï¼Œæ¥ä¸‹æ¥å°±æ˜¯é…ç½®è§„åˆ™å’Œå®ç°æ•ˆæœ

å…ˆç¡®å®šæˆ‘ä»¬è¿™ä¸€æ¬¡çš„å®ç°æ•ˆæœ

âš ï¸æ•´ä¸ªæ“ä½œï¼Œä¸æ¶‰åŠç”¨æˆ·æ³¨å†Œå’Œç™»å½•ï¼Œæ‰€ä»¥ä¹ŸæŒºå®¹æ˜“å®ç°çš„ï¼Œåˆ«å®³æ€•ï¼Œå³ä½¿æ˜¯åé¢æœ‰æ³¨å†Œå’Œç™»å½•ï¼Œä¹Ÿéƒ½æœ‰ç¬¬ä¸‰æ–¹é›†æˆï¼Œè«æ…Œï¼

è¿™ä¸ªå®ç°é€»è¾‘ï¼Œæˆ‘ä»¬æ˜¯éœ€è¦æœ‰ä¸€ä¸ªä½¿ç”¨å‚æ•°`success_url`å’Œ`signatureéªŒè¯`ç›´æ¥çœ‹åˆ°å¯¹åº”æ–‡æ¡£å®˜æ–¹è§£é‡Š

1.  æ‚¨å¯ä»¥ä¸ºæ¯ä¸ª checkout_session ä¼ é€’ä¸€ä¸ªè‡ªå®šä¹‰çš„success_urlï¼Œå®ƒå°†è¦†ç›–success_urläº§å“ä¸Šçš„è®¾ç½®ã€‚è¿™ä½¿å¾—æ‚¨å¯ä»¥åœ¨æ¯æ¬¡ä»˜æ¬¾ååŠ¨æ€åœ°å°†ç”¨æˆ·é‡å®šå‘åˆ°è‡ªå®šä¹‰é¡µé¢ï¼ˆå¯¹äºåœ¨ä»˜æ¬¾åå°†ç”¨æˆ·å¼•å¯¼åˆ°ä»–ä»¬çš„ç‰¹å®šå¸æˆ·èµ„æºå¾ˆæœ‰ç”¨ï¼‰ã€‚

1.  è¿”å›å’Œé‡å®šå‘ URL æ˜¯æˆåŠŸä»˜æ¬¾åæ‚¨çš„å®¢æˆ·å°†è¢«é‡å®šå‘åˆ°çš„ URLã€‚å®ƒä»¬åŒ…å«ç”± creem ç­¾åçš„é‡è¦ä¿¡æ¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥éªŒè¯ä»˜æ¬¾å’Œç”¨æˆ·ã€‚

åˆ’é‡ç‚¹ï¼šä»˜æ¬¾æˆåŠŸï¼Œé‡å®šå‘çš„è‡ªå®šä¹‰é¡µé¢ï¼Œä½¿ç”¨ä¿¡æ¯éªŒè¯ä»˜æ¬¾ï¼ˆå’Œç”¨æˆ·ï¼‰

ä¸€æ¬¡æ€§ä»˜è´¹æ€»å…±éœ€è¦3ä¸ªAPIï¼šåˆ›å»ºcheckoutã€ç”Ÿæˆsignatureã€éªŒè¯signature

#### API1:åˆ›å»ºä¼šè¯

```
const redirectUrl = await axios.post(
      `https://api.creem.io/v1/checkouts`,
        {
          "success_url": "https://example.com",
          "product_id": "prod_your-product-id",
        },
        {
          headers: { "x-api-key": `creem_123456789` },
        },
    );
```

çœ‹èµ·æ¥å“äººï¼Œå®é™…ä¸Šå°±4ä¸ªä¸œè¥¿ï¼š

1.  https://api.creem.io/v1/checkoutsæ”¯ä»˜è¿æ¥(å›ºå®šçš„ï¼Œæµ‹è¯•å’Œç”Ÿäº§2ä¸ªä¸åŒè¿æ¥)

1.  success_url": "https://example.com æ”¯ä»˜æˆåŠŸä»¥åä½ è¦å»åˆ°çš„é¡µé¢pathï¼ˆè·¯å¾„ï¼‰

1.  "product_id": "prod_your-product-id æ¢æˆä½ çš„äº§å“id

1.  "x-api-key": `creem_123456789 æ¢æˆä½ çš„api keyï¼ˆæµ‹è¯•å’Œç”Ÿäº§2ä¸ªä¸åŒï¼‰

æˆ‘çš„æ–‡ä»¶å¦‚ä¸‹ï¼š

```
import axios from 'axios';

export interface CreateCheckoutParams {
  productId: string;
  requestId?: string;
  successUrl?: string;
}

export interface CreateCheckoutResponse {
  checkout_url: string;
  [key: string]: any;
}

/**
 * åˆ›å»ºCreemç»“è´¦ä¼šè¯
 * @param params ç»“è´¦å‚æ•°
 * @returns åŒ…å«ç»“è´¦URLçš„å“åº”
 */
export async function createCheckout(params: CreateCheckoutParams): Promise {
  try {
    const API_URL = process.env.CREEM_API_URL || 'https://test-api.creem.io';
    const API_KEY = process.env.CREEM_API_KEY || 'creem_test_3sioDtbY5ADbmoODbQnNiW';

    // è·å–æ ¼å¼åŒ–çš„APIåŸºç¡€URLï¼ˆç¡®ä¿æ²¡æœ‰å°¾éƒ¨æ–œæ ï¼‰
    const baseUrl = API_URL.endsWith('/') ? API_URL.slice(0, -1) : API_URL;
    const apiUrl = `${baseUrl}/v1/checkouts`;

    const response = await axios.post(
      apiUrl,
      {
        product_id: params.productId,
        request_id: params.requestId,
        success_url: params.successUrl,
      },
      {
        headers: { 'x-api-key': API_KEY },
      }
    );

    if (!response.data || !response.data.checkout_url) {
      throw new Error('API response does not contain checkout_url');
    }

    return response.data;
  } catch (error) {
    console.error('Error creating checkout session:', error);
    if (axios.isAxiosError(error) && error.response) {
      console.error('API error response:', error.response.data);
    }
    throw error;
  }
} 
```

![](img/1d5835f203e6bcace0c2a79f86e242e6.png)

(GPTçš„è§£è¯»ï¼Œä¸‹é¢çš„ä½ ä¹Ÿå¯ä»¥å‘ç»™ä»»æ„aiå»çœ‹çœ‹å†™çš„åˆ°åº•æ˜¯ä»€ä¹ˆ)

#### API2:ç”Ÿæˆsignture

```
import crypto from 'crypto';

/**
 * ç”ŸæˆCreemç­¾å
 * @param params å‚æ•°å¯¹è±¡
 * @param apiKey APIå¯†é’¥
 * @returns ç”Ÿæˆçš„ç­¾å
 */
export function generateSignature(params: Record, apiKey: string): string {
  // åˆ›å»ºæ ¼å¼ä¸º "key1=value1|key2=value2|...|salt=apiKey" çš„æ•°æ®å­—ç¬¦ä¸²
  // é‡è¦ï¼šä¸è¦å¯¹é”®è¿›è¡Œæ’åº - æŒ‰ç…§æä¾›çš„é¡ºåºä½¿ç”¨
  const data = Object.entries(params)
    .map(([key, value]) => `${key}=${value}`)
    .concat(`salt=${apiKey}`)
    .join('|');

  // ä½¿ç”¨SHA-256å“ˆå¸Œç®—æ³•ç”Ÿæˆç­¾å
  const hash = crypto.createHash('sha256').update(data).digest('hex');
  return hash;
} 
```

#### API3:éªŒè¯ç­¾åsignature

```
import { generateSignature } from './signatureUtils';

export interface RedirectParams {
  request_id?: string | null;
  checkout_id?: string | null;
  order_id?: string | null;
  customer_id?: string | null;
  subscription_id?: string | null;
  product_id?: string | null;
}

/**
 * éªŒè¯Creemç­¾å
 * @param params é‡å®šå‘å‚æ•°
 * @param signature è¦éªŒè¯çš„ç­¾å
 * @returns ç­¾åæ˜¯å¦æœ‰æ•ˆ
 */
export function verifySignature(params: Record, signature: string): boolean {
  try {
    const API_KEY = process.env.CREEM_API_KEY || 'creem_test_3sioDtbY5ADbmoODbQnNiW';

    // è¿‡æ»¤æ‰null/undefinedå€¼ï¼Œå¹¶ç§»é™¤signatureå‚æ•°ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
    const filteredParams: Record <string string="">= {};
    Object.entries(params).forEach(([key, value]) => {
      if (value !== null && value !== undefined && key !== 'signature') {
        filteredParams[key] = value;
      }
    });

    // ä½¿ç”¨Creemæä¾›çš„æ–¹æ³•ç”Ÿæˆç­¾å
    const computedSignature = generateSignature(filteredParams, API_KEY);

    // æ¯”è¾ƒè®¡ç®—çš„ç­¾åä¸æ¥æ”¶åˆ°çš„ç­¾å
    return computedSignature === signature;
  } catch (error) {
    console.error('Error verifying signature:', error);
    return false;
  }
}</string> 
```

## æµ‹è¯•æ”¯ä»˜

### 3.1 æµ‹è¯•æ”¯ä»˜

æµ‹è¯•æ”¯ä»˜æ—¶ä½¿ç”¨æµ‹è¯•ä¿¡ç”¨å¡

å¡å·

```
4242 4242 4242 4242
```

å…¶ä»–ä¿¡æ¯éƒ½å¯ä»¥éšä¾¿å¡«å†™

### 3.2 å®é™…æ”¯ä»˜ï¼ˆå¿…é¡»çœ‹ï¼ç—›å¤±40åˆ€ï¼‰

å®Œæˆäº†ä»¥ä¸Šæ‰€æœ‰çš„ï¼Œä¹Ÿå®Œæˆäº†æµ‹è¯•æ¨¡å¼çš„æ”¯ä»˜ä»¥åï¼Œå‡†å¤‡å®é™…æ£€æŸ¥ä¸€ä¸‹ï¼Œç”Ÿäº§ç¯å¢ƒçš„çœŸå®æ”¯ä»˜äº†ï¼Œè¯·ä¸€å®šè¦åšä»¥ä¸‹äº‹æƒ…ï¼Œä¸ç„¶è·åŒ…çœŸçš„ä¼šç—›ï¼

#### ğŸ’¶1000å…ƒå…æ‰‹ç»­è´¹è¯´æ˜

è¿™ä¸ª1000å…ƒçš„è´§å¸å•ä½ç«Ÿç„¶æ˜¯â€œæ¬§å…ƒâ€ï¼è¯·æ³¨æ„ï¼Œä¸æ˜¯ç¾å…ƒï¼Œæ˜¯æ¬§å…ƒã€‚æˆ‘è·Ÿå½©ç¬ºéƒ½è¸©äº†è¿™ä¸ªå‘ï¼Œä¸€å¼€å§‹æˆ‘çš„äº§å“è®¾ç½®çš„å°±æ˜¯ç¾å…ƒï¼Œè‡ªå·±ç»™è‡ªå·±ä»˜äº†9.9ä»¥åå‘ç°æ‰£äº†æ‰‹ç»­è´¹ï¼åæ¥ä»”ç»†çœ‹ï¼Œè¶Šçœ‹è¶Šä¸å¯¹åŠ²å„¿ï¼Œè¿™ä¸ªç¬¦å·ï¼Œå°±æ˜¯æ¬§å…ƒç¬¦å·å§ï¼

#### ğŸ«Discount æŠ˜æ‰£

åœ¨èœå•é¡µï¼Œæœ‰ä¸€ä¸ªéå¸¸æ˜æ˜¾çš„discountæŒ‰é’®ï¼Œè¿™é‡Œå¯ä»¥è‡ªå·±åˆ›å»ºä¼˜æƒ åˆ¸ï¼Œæœ€é«˜æ˜¯100%çš„æŠ˜æ‰£ï¼Œä¹Ÿå°±æ˜¯å…è´¹ä½¿ç”¨ï¼

å…è´¹ä½¿ç”¨ï¼

åœ¨æ—æ‚¦å·±ç»™è‡ªå·±çš„æ”¯ä»˜æµ‹è¯•å†²äº†5æ¬¡9.9ç¾åˆ€ä»¥åï¼Œåœ¨å¤§å“¥çš„æé†’ä¸‹ï¼Œå‘ç°å¹¶ä½¿ç”¨äº†è¿™ç©æ„å„¿ï¼Œä¸€å¼€å§‹æˆ‘è¿˜åªæ˜¯è®¾ç½®90%ï¼Œç»“æœå¤§å“¥è‡ªå·±æµ‹è¯•çš„æ—¶å€™ï¼Œç›´æ¥ä¸Šäº†100%ï¼ˆæˆ‘ï¼Ÿï¼‰

æœ‰äº†è¿™ä¸ªæŠ˜æ‰£åˆ¸ï¼Œåœ¨æ”¯ä»˜çš„æ—¶å€™ç”šè‡³ä¸éœ€è¦è¾“å…¥é“¶è¡Œå¡ä¿¡æ¯ï¼Œåªéœ€è¦è¾“å…¥discountçš„codeå°±ä¼šæ˜¾ç¤ºFREEï¼

#### ğŸ’°Refund é€€æ¬¾

åœ¨å¤§å“¥çš„æé†’ä¸‹ï¼Œæˆ‘åˆæ— æ„ä¸­ç‚¹è¿›äº†æˆ‘çš„paymentï¼Œæƒ³ç€ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥é€€æ¬¾ï¼ˆrefundï¼‰ï¼Œè¿˜çœŸç»™æˆ‘æ‰¾åˆ°äº†ï¼Œç‚¹å‡»orderæœ€å³è¾¹çš„ä¸‰ä¸ªç‚¹ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªâ€œrefundâ€æŒ‰é’®ï¼Œ2åˆ†é’Ÿå†…å®Œæˆé€€æ¬¾

ï¼ˆå¦‚æœæ˜¯ç«‹åˆ»æ”¯ä»˜ï¼Œä¿¡ç”¨å¡è¿˜æ²¡å…¥è´¦çš„æƒ…å†µï¼Œå†™è¿™ä¸ªå¸–å­çš„æ—¶å€™ï¼Œæˆ‘æœ‰4ç¬”9.9æ˜¯å‡ å¤©å‰çš„ï¼Œè¿˜æ²¡é€€ç»™æˆ‘ï¼‰

# äº”ã€å®æˆ˜æ“ä½œæ¼”ç¤º

å‰æï¼šè¿™æ¬¡å®æˆ˜ï¼Œåªä¸“æ³¨åœ¨å¦‚ä½•æ¥æ”¯ä»˜çš„apiï¼Œå…³äºâ€œç™»å½•â€ã€â€œæ•°æ®åº“â€ç­‰éƒ¨åˆ†ä¸ä¼šè¯¦ç»†è¯´æ˜ï¼ˆåé¢æˆ‘ä¹Ÿå‡†å¤‡å†å†™ä¸€ç¯‡æ¥æ”¯ä»˜çš„ï¼‰

## 5.1 å®Œæˆçš„æ•ˆæœ

ç‚¹å‡»æŒ‰é’®ï¼Œè§¦å‘æ”¯ä»˜ï¼Œå®Œæˆæ”¯ä»˜ï¼Œè¿”å›æŒ‡å®šçš„æˆåŠŸé¡µé¢ï¼Œcreemåå°æŸ¥çœ‹é’±æ˜¯å¦æ”¶åˆ°

![](img/7523576f3c2520ea0c2180ce17571a46.png)

![](img/df5e331647922ae17672b09fd361b37c.png)

![](img/8809e1d1ed3278ea41b8a669f48efa8a.png)

![](img/c94f7c9236caa2f8ae6e5312fd789e7d.png)

![](img/6e8d99e3ec339e94d604e491d3c1f009.png)

## 5.2 ä»£ç ç»“æ„

ä¸ºäº†èŠ‚çœcursorçš„æ¬¡æ•°ï¼Œæˆ‘ä½¿ç”¨augmentä½œä¸ºæ¼”ç¤ºï¼ˆè¿˜æ²¡æœ‰ç”¨ä¸Šaugmentçš„æœ‹å‹å¯ä»¥çœ‹æˆ‘ä¹‹å‰é‚£ç¯‡augmentï¼Œç°åœ¨è¿˜èƒ½è–…ç¾Šæ¯›ï¼Œè¶Šæ—©ä¸Šè½¦è¶Šå¥½ï¼‰ï¼

```
æ”¯ä»˜æµç¨‹
â”œâ”€â”€ 1\. ç”¨æˆ·ç‚¹å‡»æ”¯ä»˜æŒ‰é’® (app/page.tsx)
â”‚   â””â”€â”€ ç”Ÿæˆå”¯ä¸€requestId
â”‚
â”œâ”€â”€ 2\. å‰ç«¯è°ƒç”¨API (app/api/create-checkout/route.ts)
â”‚   â””â”€â”€ è°ƒç”¨createCheckoutæœåŠ¡
â”‚       â””â”€â”€ services/creem/createCheckout.ts
â”‚           â”œâ”€â”€ ä½¿ç”¨ç¯å¢ƒå˜é‡è·å–APIé…ç½®
â”‚           â”œâ”€â”€ è°ƒç”¨Creem APIåˆ›å»ºç»“è´¦ä¼šè¯
â”‚           â””â”€â”€ è¿”å›checkout_url
â”‚
â”œâ”€â”€ 3\. ç”¨æˆ·è¢«é‡å®šå‘åˆ°Creemæ”¯ä»˜é¡µé¢
â”‚
â”œâ”€â”€ 4\. æ”¯ä»˜å®Œæˆåï¼ŒCreemé‡å®šå‘å›successé¡µé¢
â”‚   â”œâ”€â”€ URLåŒ…å«æ”¯ä»˜ç»“æœå‚æ•°å’Œç­¾å
â”‚   â””â”€â”€ app/success/page.tsx (æœåŠ¡ç«¯ç»„ä»¶)
â”‚       â””â”€â”€ app/success/client.tsx (å®¢æˆ·ç«¯åŒ…è£…å™¨)
â”‚           â””â”€â”€ components/SuccessContent.tsx
â”‚               â”œâ”€â”€ ä»URLè·å–å‚æ•°
â”‚               â”œâ”€â”€ è°ƒç”¨verifySignatureéªŒè¯ç­¾å
â”‚               â”‚   â””â”€â”€ services/creem/verifySignature.ts
â”‚               â”‚       â”œâ”€â”€ è¿‡æ»¤å‚æ•°
â”‚               â”‚       â””â”€â”€ è°ƒç”¨generateSignatureç”Ÿæˆç­¾å
â”‚               â”‚           â””â”€â”€ services/creem/signatureUtils.ts
â”‚               â”‚               â”œâ”€â”€ æŒ‰ç…§Creemè§„åˆ™æ ¼å¼åŒ–å‚æ•°
â”‚               â”‚               â”œâ”€â”€ æ·»åŠ APIå¯†é’¥ä½œä¸ºsalt
â”‚               â”‚               â””â”€â”€ ä½¿ç”¨SHA-256ç”Ÿæˆå“ˆå¸Œ
â”‚               â””â”€â”€ æ ¹æ®éªŒè¯ç»“æœæ˜¾ç¤ºæˆåŠŸæˆ–å¤±è´¥é¡µé¢
```

### å„æ–‡ä»¶è¯¦ç»†åŠŸèƒ½

1.  signatureUtils.ts:

*   æ ¸å¿ƒåŠŸèƒ½ï¼šç”Ÿæˆç¬¦åˆCreemè§„èŒƒçš„ç­¾å

*   å·¥ä½œæ–¹å¼ï¼šå°†å‚æ•°æŒ‰ç…§key1=value1|key2=value2|...|salt=apiKeyæ ¼å¼è¿æ¥ï¼Œç„¶åä½¿ç”¨SHA-256å“ˆå¸Œç®—æ³•ç”Ÿæˆç­¾å

*   è¢«verifySignature.tsè°ƒç”¨æ¥éªŒè¯ç­¾å

1.  verifySignature.ts:

*   æ ¸å¿ƒåŠŸèƒ½ï¼šéªŒè¯ä»Creemé‡å®šå‘å›æ¥çš„URLä¸­çš„ç­¾å

*   å·¥ä½œæ–¹å¼ï¼šè¿‡æ»¤å‚æ•°ï¼Œç§»é™¤signatureå‚æ•°ï¼Œè°ƒç”¨generateSignatureç”Ÿæˆç­¾åï¼Œç„¶åä¸URLä¸­çš„ç­¾åæ¯”è¾ƒ

*   è¢«SuccessContent.tsxç»„ä»¶è°ƒç”¨æ¥éªŒè¯æ”¯ä»˜ç»“æœ

1.  createCheckout.ts:

*   æ ¸å¿ƒåŠŸèƒ½ï¼šè°ƒç”¨Creem APIåˆ›å»ºç»“è´¦ä¼šè¯

*   å·¥ä½œæ–¹å¼ï¼šä½¿ç”¨axioså‘é€POSTè¯·æ±‚åˆ°Creem APIï¼Œè¿”å›åŒ…å«checkout_urlçš„å“åº”

*   è¢«app/api/create-checkout/route.tsè°ƒç”¨

1.  app/api/create-checkout/route.ts:

*   æ ¸å¿ƒåŠŸèƒ½ï¼šå¤„ç†å‰ç«¯æ”¯ä»˜è¯·æ±‚

*   å·¥ä½œæ–¹å¼ï¼šæ¥æ”¶å‰ç«¯è¯·æ±‚ï¼ŒéªŒè¯å‚æ•°ï¼Œè°ƒç”¨createCheckoutæœåŠ¡ï¼Œè¿”å›ç»“æœ

*   è¢«app/page.tsxä¸­çš„æ”¯ä»˜æŒ‰é’®ç‚¹å‡»äº‹ä»¶è°ƒç”¨

## 5.3 è·ŸAIå¯¹è¯çš„è¿‡ç¨‹

```
æˆ‘éœ€è¦æ¥å…¥creemï¼Œåœ¨serviceä¸‹é¢ï¼Œå¸®æˆ‘å°è£…creemçš„apiæ¥å£ï¼Œapiä¸€å…±æœ‰3ä¸ªï¼Œåˆ†åˆ«æ˜¯ â€œcreateCheckoutâ€ã€â€œsignatureUtilsâ€ã€â€œverifySignatureâ€
å…³äºè¿™ä¸‰ä¸ªçš„å‚è€ƒæ–‡ä»¶æˆ‘å·²ç»æ”¾åˆ°readmeé‡Œé¢ï¼Œä½ å¯ä»¥å‚è€ƒå­¦ä¹ ï¼Œç¯å¢ƒå˜é‡æˆ‘å·²ç»å‡†å¤‡å¥½äº†
ä»£ç å†™å®Œä»¥å è¯·æµ‹è¯•æœ€åçš„éªŒè¯signatureï¼ŒæˆåŠŸä»¥åå¤„ç†é¦–é¡µæŒ‰é’®çš„è°ƒç”¨
```

å†™å¥½mdæ–‡ä»¶ï¼Œå‘å‡ºpromptï¼Œå°±å¼€å§‹è‡ªå·±å·¥ä½œäº†

![](img/4109520b2afebecabeed0a23c3537c65.png)

å¦‚æœä½ é‡åˆ°äº† verifyå¤±è´¥ï¼Œå°±æ˜¯ä¸‹é¢è¿™ç§æƒ…å†µ

![](img/866988c9178a08895a91dfef7502ee2d.png)

å°±è®©aiæ£€æŸ¥verifyçš„ä»£ç å’Œå‚è€ƒä»£ç çš„åŒºåˆ«ï¼Œä¸¥æ ¼æŒ‰ç…§å‚è€ƒä»£ç è¿›è¡Œä¿®æ”¹ï¼š

![](img/eae5d4856dfc42ca1b451ad87d23e0a5.png)

![](img/a3511b062aa1949ff9235e4aac4b19db.png)

# å…­ã€ç¢ç¢å¿µ

ä¸€å¼€å§‹ä¸æ‡‚ï¼ŒçœŸçš„æ˜¯å¾ˆæ­£å¸¸çš„ï¼Œä¸æ‡‚å°±ç¡¬ä¸Šï¼å´©æºƒ100æ¬¡ä»¥åï¼Œå°±è¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µäº†ï¼

æ”¯ä»˜ã€ç™»å½•çœŸçš„æ˜¯2åº§å¯æ€•çš„å¤§å±±ï¼Œè¿™ç¯‡å†…å®¹å…¶å®åœ¨3æœˆåº•çš„æ—¶å€™æˆ‘å°±å†™å¥½äº†ï¼Œä¸€ç›´æƒ³åŠ ä¸€ä¸ªå®æ“æ¼”ç»ƒï¼Œç»“æœå°±æ‹–åˆ°äº†ç°åœ¨ã€‚

é¢å¯¹è¿™ä¸ªè‡ªå·±å®³æ€•çš„ä¸œè¥¿ï¼Œææ˜ç™½æ”¯ä»˜åˆ°åº•æ€ä¹ˆæ¥ï¼Œapiè¿˜æœ‰serviceä¹‹é—´çš„å…³ç³»åˆ°åº•æ˜¯æ€æ ·ï¼Œä¼¼æ‡‚éæ‡‚ç­‰äºä¸æ‡‚ï¼Œå®Œå…¨æ‡‚ï¼Œå®Œå…¨æ˜ç™½ï¼Œå®Œå…¨æŒæ¡ï¼Œæ‰ç®—çœŸæ­£å…‹æœäº†è¿™åº§å¤§å±±ã€‚å€Ÿè€å¸ˆçš„é‚£å¥è¯ï¼Œä»Šå¤©ï¼Œæˆ‘ç»ˆäºæŠŠæ”¯ä»˜è¿™é¢—ç å­ ç»™æ‰”æ‰äº†ï¼

![](img/f48edbed8b0d68a92b4e0790848910d9.png)

å¸Œæœ›è¿™ç¯‡å†…å®¹èƒ½å¸®åŠ©åˆ°éœ€è¦æ¥æ”¯ä»˜çš„ä½ ï¼Œå¦‚æœæ¥å…¥æˆåŠŸï¼Œæ¬¢è¿å›æ¥ç•™è¨€å–”ï¼